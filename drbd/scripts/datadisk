#!/bin/sh
#
# to be managed by heartbeat.
# description: Mounts and unmounts the cluster filesystem
#	  
# Copyright (C) 1999 2000, Philipp Reisner <philipp@linuxfreak.com>.
# Initial author.
#
# Copyright (C) 2000, Fábio Olivé Leite <olive@conectiva.com.br>
# Changes to support multiple devices and different distributions.
# Changes to increase robustness and exit with proper error values.
#
# Copyright (C) 2000, Thomas Mangin <thomas.mangin@free.fr>
# Mainly moved to drbdc only keep the start, stop, restart section

INSTALL="/etc/ha.d/resource.d"
. $INSTALL/drbd_commun


# See how we were called.
case "$1" in
	start)
		#setLocal

		#if [ isMasterBoot $RESOURCE ]; then
			param=`echo $* | sed -e"s/stop/master/g"`
			$INSTALL/drbdc $param
		#else
		#	$INSTALL/drbdc $RESOURCE slave
		#fi

		RV=$?
		[ $RETVAL -eq 0 ] && RETVAL=$RV
		;;

	stop)
		#if [ -n "$RESOURCE" ]; then
			param=`echo $* | sed -e"s/stop/slave/g"`
			$INSTALL/drbdc $param
		#else
		#	$INSTALL/drbdc slave
		#fi
		;;
		
	restart)
		#if [ -n "$RESOURCE" ]; then
		#	$0 $RESOURCE stop
		#	$0 $RESOURCE start
		#else
			$0 stop
			$0 start
		#fi
		;;
	status)
		$INSTALL/drbdc $*
		;;

	*)
		echo "Usage: $0 [resource] {start|stop|restart}"
		RETVAL=1
		;;
esac

exit $RETVAL
